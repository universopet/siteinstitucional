"use strict";(globalThis.webpackChunknewfold_Onboarding=globalThis.webpackChunknewfold_Onboarding||[]).push([[619],{619:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var i=n(8468),s=n(7143),r=n(4348),a=n(6087),o=n(7723);var d=n(7708),g=n(7517),c=n(1056),l=n(3988),p=n(7044),u=n(790);const _=()=>(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"24",viewBox:"-5 -2 36 24",fill:"none",className:"heart",children:(0,u.jsx)("g",{id:"State=Active",children:(0,u.jsx)("path",{id:"Vector",d:"M10 19.1585L8.975 18.2335C7.20833 16.6168 5.75 15.221 4.6 14.046C3.45 12.871 2.53333 11.821 1.85 10.896C1.16667 9.971 0.6875 9.1335 0.4125 8.3835C0.1375 7.6335 0 6.87516 0 6.1085C0 4.6085 0.504167 3.35433 1.5125 2.346C2.52083 1.33766 3.76667 0.833496 5.25 0.833496C6.2 0.833496 7.07917 1.0585 7.8875 1.5085C8.69583 1.9585 9.4 2.6085 10 3.4585C10.7 2.5585 11.4417 1.896 12.225 1.471C13.0083 1.046 13.85 0.833496 14.75 0.833496C16.2333 0.833496 17.4792 1.33766 18.4875 2.346C19.4958 3.35433 20 4.6085 20 6.1085C20 6.87516 19.8625 7.6335 19.5875 8.3835C19.3125 9.1335 18.8333 9.971 18.15 10.896C17.4667 11.821 16.55 12.871 15.4 14.046C14.25 15.221 12.7917 16.6168 11.025 18.2335L10 19.1585Z",fill:"#EF4A71"})})}),h=function({count:e=1,isRegenerating:t}){const n=[];for(let i=0;i<e;i++)n.push((0,u.jsx)("div",{className:"regenerating-site-card-wrap",children:(0,u.jsxs)("div",{className:"regenerating-site-card",children:[(0,u.jsx)("p",{className:"regenerating-site-card__title",children:t?(0,o.__)("Regenerating Site","wp-module-onboarding"):(0,o.__)("Generating Site","wp-module-onboarding")}),(0,u.jsx)("div",{className:"regenerating-site-card__progress-bar",children:(0,u.jsx)("div",{style:{animationDuration:2e3*Math.random()+1500+"ms"},className:"regenerating-site-card__progress-bar__fill"})})]})},i));return(0,u.jsx)(u.Fragment,{children:n})};var v=n(431),m=n(1032),w=n(2202),b=n(8744),f=n(7675),y=n(8969);const x=()=>{const[e,t]=(0,i.useState)(!1),[n,x]=(0,i.useState)(!1),[C,j]=(0,i.useState)(!1),[S,N]=(0,i.useState)(!1),E=(0,r.Zp)(),k=(0,i.useRef)(),{currentData:D,nextStep:F,siteGenErrorStatus:G,themeStatus:I}=(0,s.useSelect)((e=>({currentData:e(f.M).getCurrentOnboardingData(),nextStep:e(f.M).getNextStep(),siteGenErrorStatus:e(f.M).getSiteGenErrorStatus(),themeStatus:e(f.M).getThemeStatus()}))),{setIsHeaderEnabled:R,setSidebarActiveView:A,setHeaderActiveView:O,setDrawerActiveView:M,setCurrentOnboardingData:H,updateInitialize:T,setHideFooterNav:V,updateSiteGenErrorStatus:B,setIsHeaderNavigationEnabled:W}=(0,s.useDispatch)(f.M);(0,i.useEffect)((()=>{R(!1),V(!0),A(!1),O(y.Ix),M(!1),T(!0),W(!1)}),[]),(0,i.useEffect)((()=>{!0===k.current&&!1===G&&(Z(),L(),W(!1)),k.current=G}),[G]);const Z=async()=>{if(j(!0),!(0,a.isEmpty)(D.sitegen.homepages.data))return t(D.sitegen.homepages.data),j(!1),void z();if(""===D.sitegen.siteDetails?.prompt)return void j(!1);const e=await(0,d.c7)(D.sitegen.siteDetails.prompt,D.sitegen.siteDetails.locale);if(e.error)return j(!1),(0,c.v)(new c.iC(w.cW,"homepages",{source:b.d0})),void B(!0);D.sitegen.homepages.data=e.body,t(e.body),H(D),j(!1),z()},z=()=>{window.nfdOnboarding.siteGenTimerInterval&&(clearInterval(window.nfdOnboarding.siteGenTimerInterval),(0,c.v)(new c.iC(w.uv,window.nfdOnboarding.siteGenTime,{source:b.d0})))},L=async()=>{const e=await(0,g.w6)();e.error?j(!1):N(e.body)};(0,i.useEffect)((()=>{y.Er===I&&(Z(),L())}),[I]);const P=(t,n)=>{if(!(t in e))return!1;D.sitegen.homepages.active=e[t],D.sitegen.skipCache=!1,H(D),(0,c.v)(new c.iC(w.Wi,t,{position:n,source:b.d0})),E(F.path)},q=(n,i)=>{if(!(n in e))return;const s=!e[n].isFavorite;e[n].isFavorite=s,D.sitegen.homepages.data=e,t(e),H(D),(0,c.v)(new c.iC(w.Nz,n,{favorite:s,placement:"preview_grid",position:i,source:b.d0}))},U=async(n,i,s,r)=>{if(document.getElementsByClassName("nfd-onboarding-step--site-gen__preview__note")&&document.getElementsByClassName("nfd-onboarding-step--site-gen__preview__note")[0].scrollIntoView({behavior:"smooth",block:"end"}),x(!0),!(n in e))return void x(!1);if(""===D.sitegen.siteDetails?.prompt)return void x(!1);const a=await(0,d.HA)(D.sitegen.siteDetails.prompt,n,i,s);if(a.error)return void x(!1);const o=a.body;e[o.slug]=o,D.sitegen.homepages.data=e,t(e),H(D),x(!1),(0,c.v)(new c.iC(w.Hf,n,{position:r,source:b.d0,placement:"preview_grid"}))},X={heading:(0,o.__)("Presto, here are 3 versions","wp-module-onboarding"),subheading:(0,o.__)("We've created 3 unique website designs for you to start with, preview click around or start over.","wp-module-onboarding"),favouriteNote:(0,o.__)("Favorite a generated version to find and use again in the future.","wp-module-onboarding"),generating:(0,o.__)("Generating Site","wp-module-onboarding"),regenerating:(0,o.__)("Regenerating Site","wp-module-onboarding")};return(0,u.jsx)(m.UX,{render:!1,children:(0,u.jsx)(m.tR,{children:(0,u.jsxs)(l.A,{className:"nfd-onboarding-step--site-gen__preview",children:[(0,u.jsx)("div",{className:"nfd-onboarding-step--site-gen__preview__container",children:!C&&(0,u.jsxs)(v.A,{type:"fade-in",children:[(0,u.jsx)("div",{className:"nfd-onboarding-step--site-gen__preview__container__heading",children:(0,u.jsx)("p",{className:"nfd-onboarding-step--site-gen__preview__container__heading__text",children:X.heading})}),(0,u.jsx)("div",{className:"nfd-onboarding-step--site-gen__preview__container__sub-heading",children:(0,u.jsx)("p",{className:"nfd-onboarding-step--site-gen__preview__container__sub-heading__text",children:X.subheading})})]})}),(0,u.jsxs)("div",{className:"nfd-onboarding-step--site-gen__preview__options",children:[e&&S&&!C?Object.keys(e).map(((t,i)=>{const s=e[t],r=(0,a.cloneDeep)(S[0]);r.settings.color.palette=s.color.palette;const o=s.styles?.blocks[0]?.["core/body"]?.typography?.fontFamily,d=s.styles?.blocks[0]?.["core/heading"]?.typography?.fontFamily;r.styles.typography&&o&&(r.styles.typography.fontFamily=o),r.styles.blocks["core/heading"].typography&&d&&(r.styles.blocks["core/heading"].typography.fontFamily=d);let g="";return["header","content","footer"].forEach((e=>{e in s&&(g+=s[e])})),(0,u.jsx)(p.GZ,{blockGrammar:g,previewSettings:r,slug:t,position:i+1,title:s.title,isFavorite:s.isFavorite,palette:s.color,styling:"custom",overlay:!0,tabIndex:"0",role:"button",handleFavorite:q,handleRegenerate:U,handlePreview:P,isRegenerating:n},i)})):(0,u.jsx)(h,{count:3,isRegenerating:!1}),n&&(0,u.jsx)(h,{count:1,isRegenerating:!0})]}),(0,u.jsxs)("div",{className:"nfd-onboarding-step--site-gen__preview__note",children:[(0,u.jsx)(_,{}),(0,u.jsx)("span",{children:X.favouriteNote})]})]})})})}}}]);